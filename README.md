# MarketMonarch
**MarketMonarch** is a Maven-based Java prototype trading bot designed for use with [Interactive Brokers](https://www.interactivebrokers.com/).  
It executes trades, performs technical analysis, logs activity, generates session reports, and emails them to you.  
Think of it as a *robotic trader* who is very eager to trade‚Ä¶ but not particularly good at making you rich (more on that below).


‚ö†Ô∏è **Disclaimer**

**I take zero responsibility for any financial losses** this software may cause. If it *did* make money consistently, I probably wouldn't be sharing it for free ‚Äî I‚Äôd be sipping cocktails on a beach somewhere. 
**It is a prototype** ‚Äî lots of features can (and should) be improved. For example:
   - Move trading constants into a config file instead of hard-coding them
   - Implement smarter entry/exit logic
   - Actually use the calculated performance metrics for decision-making
   - **The PDF password is currently hard-coded in the source code** ‚Äî this is insecure and should be replaced with a proper configuration solution  


üîß **Prerequisites (Accounts & Tools)**  

*Interactive Brokers (IBKR) Account*  
  - Active IBKR account with **TWS or IB Gateway** installed and API access enabled.  
  - Additionally, you need to download and install the **Trader Workstation (TWS) or IB Gateway software**, as well as the **official IB API source code** (including `EWrapper`, `EClientSocket`, etc.).  
  - All required software and API documentation can be found here: [IBKR API Page](https://ibkrcampus.com/campus/ibkr-api-page/twsapi-doc/).
  - **Required Market Data Subscriptions** (to receive live data):  
    - **US Securities Snapshot and Futures Value Bundle (NP, L1)** ‚Äì via Trader Workstation  
    - **US Equity and Options Add-On Streaming Bundle (NP)** ‚Äì via Trader Workstation
    
*Mailtrap Account*
  - Used to send the password-protected session report via SMTP in a safe sandbox.
  
*MySQL Server*
  - Required for credentials storage and trade/performance data.
  - You‚Äôll need a user with CREATE/ALTER permissions for initial setup.
  
*Java & Build Tooling*
  - **Java 21** (Amazon Coretto) and **Maven 3.8+** installed locally.
  - OS-specific packaging depends on your environment (EXE + NSIS are Windows-only).
  
*PDF Viewer*
  - To open password-protected PDF session reports generated by the bot.



‚öôÔ∏è **Configuration**

MarketMonarch uses a central configuration file for database connections and credentials.
*Location* 
   src/main/resources/Configuration.json
   
*Content Example*
   
```json
{
  "Username": "<username>"
  "Password": "<yourpassword>",
  "URL-api_key": "jdbc:mysql://<host>:<port>/api_key",
  "URL-financial_data": "jdbc:mysql://<host>:<port>/financial_data",
  "URL-test_db": "jdbc:mysql://<host>:<port>/test_db",
} 
```

*Explanation*
- Username           -> Database user (e.g. root)
- Password           -> Password for the database user
- URL-api_key        -> URL for API key storage 
- URL-financial_data -> URL for financial data storage
- URL-test_db        -> URL for test database 

*Security Note*
- Never commit this file with real credentials to a public repository. For production, use environment variables or a secrets manager.


üõ¢Ô∏è **Database Structure**

*Database:* `api_key`

Table: `credentials`  
<table>
  <tr><th>Column</th><th>Type</th><th>Primary Key</th><th>Not Null</th><th>Auto Increment</th></tr>
  <tr><td>provider</td><td>VARCHAR(150)</td><td>YES</td><td>YES</td><td>NO</td></tr>
  <tr><td>token</td><td>VARCHAR(512)</td><td>NO</td><td>YES</td><td>NO</td></tr>
</table>



*Database:* `financial_data`

Table: `trade`  
<table>
  <tr><th>Column</th><th>Type</th><th>Primary Key</th><th>Not Null</th><th>Auto Increment</th></tr>
  <tr><td>id</td><td>INT</td><td>YES</td><td>YES</td><td>YES</td></tr>
  <tr><td>symbol</td><td>VARCHAR(20)</td><td>NO</td><td>YES</td><td>NO</td></tr>
  <tr><td>entry_price</td><td>DECIMAL(18,4)</td><td>NO</td><td>YES</td><td>NO</td></tr>
  <tr><td>exit_price</td><td>DECIMAL(18,4)</td><td>NO</td><td>YES</td><td>NO</td></tr>
  <tr><td>quantity</td><td>INT</td><td>NO</td><td>YES</td><td>NO</td></tr>
  <tr><td>entry_time</td><td>TIMESTAMP</td><td>NO</td><td>YES</td><td>NO</td></tr>
  <tr><td>exit_time</td><td>TIMESTAMP</td><td>NO</td><td>YES</td><td>NO</td></tr>
  <tr><td>stop_loss</td><td>DECIMAL(18,4)</td><td>NO</td><td>NO</td><td>NO</td></tr>
  <tr><td>take_profit</td><td>DECIMAL(18,4)</td><td>NO</td><td>NO</td><td>NO</td></tr>
  <tr><td>order_efficiency_ratio</td><td>DECIMAL(18,4)</td><td>NO</td><td>NO</td><td>NO</td></tr>
</table>

*Database:* `test_db`

Table: `test_db` 
<table>
  <tr><th>Column</th><th>Type</th><th>Primary Key</th><th>Not Null</th><th>Auto Increment</th></tr>
  <tr><td>id</td><td>VARCHAR(255)</td><td>YES</td><td>YES</td><td>NO</td></tr>
  <tr><td>name</td><td>VARCHAR(45)</td><td>NO</td><td>NO</td><td>NO</td></tr>
</table>  
  
  
‚öôÔ∏è **Build Process**

üì¶ *Fat JAR Creation (maven-assembly-plugin)*
- Bundles **all dependencies** into a single executable JAR.  
- `Main-Class` is defined in the manifest ‚Üí JAR can be launched directly.  
- Ensures the bot runs **standalone** without external library resolution.  



üíª *EXE Packaging (launch4j-maven-plugin)*
- Wraps the fat JAR into a **Windows .exe** using Launch4j.  
- Configurations include:  
  - console or GUI header type  
  - optional custom application icon (`icon.ico`)  
  - output in the `target/` directory as `<project>.exe`  
- ‚ö†Ô∏è **Windows-specific step**.  



üìÄ *Installer Generation (exec-maven-plugin + NSIS)*
- Builds an installer with **NSIS (Nullsoft Scriptable Install System)**.  
- Maven executes `makensis.exe` with the project‚Äôs custom script (`installer.nsi`).  
- The installer bundles the `.exe` and required resources into a distributable package.  
- **Output:** ready-to-install setup executable.  

üõ†Ô∏è *Maven Build*
- Execute with: `mvn clean verify`  
  - Cleans previous outputs and builds the project, running all tests.  
  - ‚ö†Ô∏è Some tests require the Gateway to be running.  


- Optionally execute with: `mvn clean verify -Dmaven.test.skip=true`  
  - Skips all tests, useful if the Gateway is not available.  
  - Cleans previous outputs and builds the project artifacts without executing tests.

**Attribution**

This project includes an icon downloaded from [icon-icons.com](https://icon-icons.com/).

- **Icon Name:** Going up two bars chart / Graph / Data analysis  
- **Author:** Goce Mitevski  
- **Source:** [https://icon-icons.com/icon/Going-up-two-bars-chart-graph-data-analysis-graph/114381](https://icon-icons.com/icon/Going-up-two-bars-chart-graph-data-analysis-graph/114381)  
- **License:** Free icon-icons license (with attribution)

The icon is used in accordance with the license, which requires attribution to the author in the definitive project.

