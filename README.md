# MarketMonarch
**MarketMonarch** is a Maven-based Java prototype trading bot designed for use with [Interactive Brokers](https://www.interactivebrokers.com/).  
It executes trades, performs technical analysis, logs activity, generates session reports, and emails them to you.  
Think of it as a *robotic trader* who is very eager to trade‚Ä¶ but not particularly good at making you rich (more on that below).


‚ö†Ô∏è **Disclaimer**

**I take zero responsibility for any financial losses** this software may cause. If it *did* make money consistently, I probably wouldn't be sharing it for free ‚Äî I‚Äôd be sipping cocktails on a beach somewhere. 
**It is a prototype** ‚Äî lots of features can (and should) be improved. For example:
   * Move trading constants into a config file instead of hard-coding them
   * Implement smarter entry/exit logic
   * Actually use the calculated performance metrics for decision-making  


üîß **Prerequisites (Accounts & Tools)**  

*Interactive Brokers (IBKR) Account*  
  - Active IBKR account with **TWS or IB Gateway** installed and API access enabled.  
  - Additionally, you need to download and install the **Trader Workstation (TWS) or IB Gateway software**, as well as the **official IB API source code** (including `EWrapper`, `EClientSocket`, etc.).  
  - All required software and API documentation can be found here: [IBKR API Page](https://ibkrcampus.com/campus/ibkr-api-page/twsapi-doc/).
    
*Mailtrap Account*
  - Used to send the password-protected session report via SMTP in a safe sandbox.
  
*MySQL Server*
  - Required for credentials storage and trade/performance data.
  - You‚Äôll need a user with CREATE/ALTER permissions for initial setup.
  
*Java & Build Tooling*
  - **Java 21** (Amazon Coretto) and **Maven 3.8+** installed locally.
  - OS-specific packaging depends on your environment (EXE + NSIS are Windows-only).
  
*PDF Viewer*
  - To open password-protected PDF session reports generated by the bot.



‚öôÔ∏è **Configuration**

MarketMonarch uses a central configuration file for database connections and credentials.
*Location* 
   src/main/resources/Configuration.json
   
*Content Example*
   
```json
{
  "Password": "<yourpassword>",
  "URL-test_db": "jdbc:mysql://localhost:3306/test_db",
  "URL-api_key": "jdbc:mysql://localhost:3306/api_key",
  "URL-financial_data": "jdbc:mysql://localhost:3306/financial_data",
  "Username": "<username>"
} 
```

   *Explanation*
  - Username           -> Database user (e.g. root)
  - Password           -> Password for the database user
  - URL-test_db        -> Connection string for test database
  - URL-api_key        -> Connection string for API key storage (e.g. "jdbc:mysql://localhost:3306/api_key")
  - URL-financial_data -> Connection string for financial data storage

   *Security Note*
  - Never commit this file with real credentials to a public repository. For production, use environment variables or a secrets manager.


üõ¢Ô∏è **Database Structure**

*api_key Database*

Table: `credentials`  
<table>
  <tr><th>Column</th><th>Type</th><th>Primary Key</th><th>Not Null</th><th>Auto Increment</th></tr>
  <tr><td>provider</td><td>VARCHAR(150)</td><td>YES</td><td>YES</td><td>NO</td></tr>
  <tr><td>token</td><td>VARCHAR(512)</td><td>NO</td><td>YES</td><td>NO</td></tr>
</table>



*financial_data Database*

Table: `trade`  
| Column                  | Type           | Required | Description                                                   |
|-------------------------|---------------|----------|---------------------------------------------------------------|
| `id`                    | INT           | Yes      | Internal broker ID (e.g., order or trade ID)                 |
| `symbol`                | VARCHAR(20)   | Yes      | Stock symbol of the traded asset                              |
| `entry_price`           | DECIMAL(18,4) | Yes      | Entry price per unit                                          |
| `exit_price`            | DECIMAL(18,4) | Yes      | Exit price per unit                                           |
| `quantity`              | INT           | Yes      | Number of shares/contracts traded                             |
| `entry_time`            | TIMESTAMP     | Yes      | Timestamp when the position was opened                        |
| `exit_time`             | TIMESTAMP     | Yes      | Timestamp when the position was closed                        |
| `stop_loss`             | DECIMAL(18,4) | No       | Optional stop-loss price                                      |
| `take_profit`           | DECIMAL(18,4) | No       | Optional take-profit price                                     |
| `order_efficiency_ratio`| DECIMAL(18,4) | No       | Ratio of modifications/cancellations vs. executed trades     | 



*test_db Database*

Table: `test_db` 
  - `id` VARCHAR(255) **PRIMARY KEY, NOT NULL** ‚Äì Unique identifier  
  - `name` VARCHAR(45) ‚Äì Test name field  
  
  
‚öôÔ∏è **Build Process**

üì¶ *Fat JAR Creation (maven-assembly-plugin)*
- Bundles **all dependencies** into a single executable JAR.  
- `Main-Class` is defined in the manifest ‚Üí JAR can be launched directly.  
- Ensures the bot runs **standalone** without external library resolution.  



üíª *EXE Packaging (launch4j-maven-plugin)*
- Wraps the fat JAR into a **Windows .exe** using Launch4j.  
- Configurations include:  
  - console or GUI header type  
  - optional custom application icon (`icon.ico`)  
  - output in the `target/` directory as `<project>.exe`  
- ‚ö†Ô∏è **Windows-specific step**.  



üìÄ *Installer Generation (exec-maven-plugin + NSIS)*
- Builds an installer with **NSIS (Nullsoft Scriptable Install System)**.  
- Maven executes `makensis.exe` with the project‚Äôs custom script (`installer.nsi`).  
- The installer bundles the `.exe` and required resources into a distributable package.  
- **Output:** ready-to-install setup executable.  


**Attribution**

This project includes an icon downloaded from [icon-icons.com](https://icon-icons.com/).

- **Icon Name:** Going up two bars chart / Graph / Data analysis  
- **Author:** Goce Mitevski  
- **Source:** [https://icon-icons.com/icon/Going-up-two-bars-chart-graph-data-analysis-graph/114381](https://icon-icons.com/icon/Going-up-two-bars-chart-graph-data-analysis-graph/114381)  
- **License:** Free icon-icons license (with attribution)

The icon is used in accordance with the license, which requires attribution to the author in the definitive project.

